name: Use Service Account Secret

on:
  push:
    branches: [ main ]

jobs:
  use-service-account:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Save service account secret to file
        shell: bash
        run: |
          set -e
          echo "Creando archivo temporal con la clave de servicio (solo en runner)..."
          printf '%s' "${{ secrets.FIREBASE_SERVICE_ACCOUNT }}" > ./serviceAccountKey.json
          ls -l serviceAccountKey.json || true

      - name: Example: use the service account (placeholder)
        shell: bash
        run: |
          echo "Aquí usarías la clave para autenticar herramientas, por ejemplo gcloud o firebase-tools."
          echo "No pongas comandos de producción aquí sin revisar roles y permisos."

      - name: Remove service account file
        shell: bash
        run: |
          shred -u serviceAccountKey.json || rm -f serviceAccountKey.json
